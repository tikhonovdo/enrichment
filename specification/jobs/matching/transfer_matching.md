## transferMatchingStep

1. В таблице <u>transaction</u> найти пары кандидатов на регистрацию переводов в таблицу <u>transfer</u> по
   * равенству значения `transaction.sum`,
   * равенству значения `transaction.date` (в рамках дня),
   * неравенству `transaction.type` и
   * неравенству `transaction.account_id`.

2. Для этих записей в таблице <u>transfer</u> следует задать:
   * `transaction.category_id = null`,
   * `transaction.event_id = 1`

3. Для каждой найденной записи создать запись в <u>transfer</u> по следующим правилам:

| Поле <u>`transfer`</u> | Значение                                     |
|------------------------|----------------------------------------------|
| name                   | "Перевод"                                    |
| transaction_id_from    | `transaction.id`, где `transaction.type = 2` |
| transaction_id_to      | `transaction.id`, где `transaction.type = 1` |
| validated              | `false`                                      |

> Флаг `validated` вводится на этапе разработки, 
> чтобы было проще проверять стабильность поиска.
> В рамках целевого решения есть желание от него отказаться. 


```
Возможно в Тинькофф сделают новый столбец "Комментарий" и тогда получится создать
правила матчинга переводов и компенсаций в рамках групповых трат (например в ресторанах 
или при совместной покупке билетов).
 
В Альфе такое поле уже есть, но я его не проверял - давно не пользовался из дебетовкой.
```